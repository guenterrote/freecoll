\documentclass{patmorin}
\usepackage[utf8]{inputenc}
\usepackage{amsthm,amsmath,graphicx}
\usepackage{array}
\usepackage{pat}
\usepackage{hyperref}
\usepackage[dvipsnames]{xcolor}
\definecolor{linkblue}{named}{Blue}
\hypersetup{colorlinks=true, linkcolor=linkblue,  anchorcolor=linkblue,
citecolor=linkblue, filecolor=linkblue, menucolor=linkblue,
urlcolor=linkblue, pdfcreator=Me, pdfproducer=Me} \setlength{\parskip}{1ex}
\usepackage{tikz}

\usepackage{paralist}

\DeclareMathOperator{\sgn}{sgn}


\listfiles
\newcommand{\lstlabel}[1]{\label{lst:#1}}
\newcommand{\lstref}[1]{Listing~\ref{lst:#1}}
\newcommand{\Lstref}[1]{\lstref{#1}}

\DeclareMathOperator{\block}{block}
\newcommand{\naive}{na\"{\i}ve}


\newcommand{\reals}{\mathbb{R}}
\newcommand{\integers}{\mathbb{Z}}
\newcommand{\naturals}{\mathbb{N}}
\newcommand{\dist}{{d}}

\title{\MakeUppercase{Every Collinear Set is Free}}

\author{Bellairs Workshop on Geometry and Graphs 2017--18}

\begin{document}
\maketitle


\begin{abstract}
  We show that if a planar graph $G$ has a planar straight-line drawing
  in which a subset $S$ of its vertices are collinear, then there is a
  planar straight-line drawing of $G$ in which all vertices in $S$ are
  on the $y$-axis and in which they have prescribed $y$-coordinates.
  This solves an open problem posed by Ravsky and Verbitsky in 2008.
  In their terminology, we show that every collinear set is free.
  This result has applications in graph drawing, untangling, universal
  point subsets, and related areas.
\end{abstract}


\section{Introduction}

In a planar graph, $G=(V,E)$, a \emph{collinear set} is a set of vertices
$S\subset V$ such that $G$ has a planar straight-line drawing in which
all vertices in $S$ are drawn on a single line.  A collinear set $S$
is a \emph{free collinear set} if, for any collinear set of points
$X\subset\R^2$, $|X|=|S|$, $G$ has a planar straight-line drawing in
which the vertices of $S$ are drawn on the points in $X$.  Ravsky and
Verbitsky \cite{ravsky.verbitsky:on} ask the following question:

\begin{quote}
   How far or close are parameters $\tilde{v}(G)$ and $\bar{v}(G)$? It
   seems that \emph{a priori} we even cannot exclude equality. To clarify
   this question, it would be helpful to (dis)prove that every collinear
   set in any straight line drawing is free.
\end{quote}

In the context of this quote, $\tilde{v}(G)$ and $\bar{v}(G)$ are the
respective sizes of the largest collinear set and largest free collinear
set in $G$.  In this note, we prove that $\tilde{v}(G)=\bar{v}(G)$ by
showing that every collinear set is a free collinear set.  

Dujmovi\'c and Frati gave the following characterization of collinear sets:
\begin{thm}
   A set $S$ of the vertices of a graph $G$ is a collinear set if
   and only if there exists a (topological) drawing of $G$ and a simple
   curve $C$ both endpoints in a common face of $G$ and such that each
   vertex of $S$ is drawn on $C$ and the intersection of each edge with
   $C$ has at most one connected component.
\end{thm}
The surprising aspect of this characterization is that one can
simultaneously straighten the drawing of the graph so that it becomes a
straight line drawing and straighten the Jordan curve so that it becomes
(say) the y-axis while preserving the combinatorial relationship between
$C$ and $G$.

\subsection{Proof Sketch}


Without loss of generality, we may assume that the the graph we are
interested in is a (topological) triangulation $T$ and the line we are
interested in is the y-axis.

%Our proof has three steps:
%\begin{enumerate}
%   \item Using combinatorial operations---edge subdivision, edge
%   contraction, and the removal of separating triangles---and induction
%   on the number of vertices, we reduce to a problem in which $T$
%   has no separating triangles and every edge of $T$ is incident to a
%   triangle that has two edges intersecting the y-axis and $S$ is an
%   independent set that is on the y-axis.
%
%   \item Using local operations---removing edges and vertices and
%   introducting edges---on $T$ we obtain a (topological) quadrangulation
%   $Q$ for which every edge intersects the y-axis and $S$ is on the
%   y-axis.  Furthermore, $Q$ is structured so that, if we take any
%   non-crossing straigh-line drawing of $Q$ we can rei
%
%   \item Thus we have a quadrangulation $Q$ whose edges intersect
%   the y-axis in the order $e_1,\ldots,e_m$ and the vertex set of $Q$
%   contains $S$, still on the y-axis.
%
%   Let $y_1\le\cdots\le y_m$ be any sequence of numbers such that
%   $y_i=y_{i+1}$ if and only if $e_i$ and $e_{i+1}$ have a common endpoint
%   in $S$.  We show that, for any $\epsilon >0$, $Q$ has a planar
%   straight-line drawing such that the intersection of $e_i$ with the
%   y-axis is at $y_i\pm\epsilon$.  Furthermore, if $y_i=y_{i+1}$, then
%   the intersection of $e_i$ and $e_{i+1}$ with the y-axis is exactly
%   at $y_i$. In this way every vertex of $S$ is drawn on the y-axis
%   at precisely the desired location.
%\end{enumerate}


works in three basic steps: 


\section{Definitions}

Jordan curve

embedding of a graph = each vertex is a distinct point and each edge is a closed curve whose endpoints are its two vertices.  

we identify vertices of an embedded graph with their points and edges with their curves. By default, an edge curve includes its endpoints, otherwise we specify that it is an \emph{open} edge.

clean embedding - an embedding where the intersection between two edge curves is a finite set.  

rotation system = a graph with an ordering of the edges around each vertex. Every clean embedding defines a rotation system.

straight-line embedding = an embedding in which each edge curve is a line segment

plane embedding = an embedding in which no two edges intersect except possibly at their common endpoint.

face = one of the maximal connected subsets of $\R^2$ that remains after removing the union of all edges

for plane embeddings, we use the convention of listing the vertices of a face in counterclockwise order.

Triangulation = plane embedded graph in which each face is bounded by a 3-cycle.

Quadrangulation = plane embedded graph in which each face is bounded by a 4-cycle. Has $n\ge 4$ vertices and $2n-4$ edges.

Drawing = plane embedding 

Straight-line drawing = straight-line plane embedding

cutset = set of vertices whose removal disconnects the graph

separating triangle = cut set of size 3 in a triangulation

edge contraction = contracting $xy$ identifies $x$ and $y$ into a single vertex $v$ and eliminates any resulting parallel edges.  Preserves triangulations provided that $x$ and $y$ is not part of any separating triangle.


\section{The Proof}

\subsection{Drawing Quadrangulations}
\seclabel{quad}

\begin{lem}
   Let $Q$ be a drawing of a quadrangulation with $n\ge 5$ vertices
   and let $Q'$ be a straight-line embedding of $Q$ that has the same
   rotation system as $Q$.  Then $Q'$ is a straight-line drawing of $Q$.
\end{lem}

\begin{proof}
   Some argument about how a crossing in $Q'$ would require some
   quadrilateral face to have a vertex whose edge ordering is different
   in $Q$ than in $Q'$
\end{proof}

\begin{lem}\lemlabel{quad}
    \begin{compactitem}
    \item $Q$ be a quadrangulation with outer face $f$; 
    \item $C:[0,1]\to\R^2$ be a simple curve
     whose endpoints are both in the interior of $f$, 
     whose intersection with each open edge of $Q$
     consists of exactly one point, and that does not contain
     any vertex of $Q$; 
    \item $e_1,\ldots,e_m$ be the edges of $Q$ in the
    order they are intersected by $C$; 
    \item $y_1<\cdots<y_m$
    be any increasing sequence of numbers; and
    \item $\Delta$ be a triangle whose intersection with the y-axis
     is the segment $p_1p_m$ with endpoints $p_1=(0,y_1)$ and $p_m=(0,y_m)$.
    \end{compactitem}
    Then $Q$ has a straight-line
    drawing in which, for each $i\in\{1,\ldots,m\}$, the intersection
    of $e_i$ with the y-axis is a single point $(0,y_i)$ and the edges
    $e_1$ and $e_m$ are mapped to the the two edges of $\Delta$ that
    intersect the y-axis.
\end{lem}

\begin{proof}
   G\"unter's proof showing that the resulting system of equations has a unique solution.
\end{proof}

Next, we present a strengthening of \lemlabel{quad} that allows vertices
of $Q$ to be on the curve $C$.  Let $r_1,\ldots,r_m$ be a sequence
of vertices and edges in a planar graph and let $y_1<\cdots<y_m$ be a
sequence of numbers.  We say that a triangle $\Delta=\alpha\beta\gamma$
is \emph{compatible} with $r_1,\ldots,r_m$ and $y_1,\ldots,y_m$ if
\begin{compactenum}
  \item $\beta=p_1$ if $r_1$ is a vertex, otherwise $p_1$ in the interior
  of the edge $\alpha\beta$; and
  \item $\gamma=p_m$ if $r_m$ is a vertex, otherwise $p_m$ in the interior
  of the edge $\alpha\gamma$.
\end{compactenum}

\begin{lem}\lemlabel{quad}
    Let
    \begin{compactitem}
    \item $Q$ be a quadrangulation with outer face $f$; 
    \item $C:[0,1]\to\R^2$ be a Jordan curve
     whose endpoint $C(0)=C(1)$ is in the interior of $f$, and
     whose intersection with each edge of $Q$
     consists of exactly one point;
    \item $r_1,\ldots,r_m$ be the edges and vertices of $Q$ in the
    order they are intersected by $C$; 
    \item $y_1<\cdots<y_m$
    be any increasing sequence of numbers; and
    \item $\Delta$ is a triangle that is compatible with $r_1,\ldots,r_m$ and $y_1,\ldots,y_m$.
    \end{compactitem}
    Then $Q$ has a straight-line
    drawing in which, for each $i\in\{1,\ldots,m\}$, the intersection
    of $r_i$ with the y-axis is a single point $(0,y_i)$ and three vertices
    of $f$ are mapped to the vertices of $\Delta$
\end{lem}

\begin{proof}
   To fix this, first note that any vertex $r_i$ on $C$ is only incident
   only to crossing edges and therefore the neighbours of $r_i$ are all
   contained in $R$. Thus, we can deform $C$ in the neighbourhood of $r_i$
   so that $r_i$ moves into the interior of $L$ and $C$ intersects each
   of $r_i$'s incident edges $e_1,\ldots,e_d$ in exactly one point.  Now,
   to apply \lemref{quad} we must specify numbers $y_1',\ldots,y_d'$ where
   $(0,y_i')$ is the intersection point between $e_j$ and the y-axis.
   To do this we choose any $y_1'<\cdots<y_d'$ satisfying
   \[
       y_{i-1} < y_1' < y_i < y_d' < y_{i+1} \enspace .
   \]
   By doing this for each vertex $r_i$ in $C$ we obtain a curve $C'$ and
   a sequence $y_1''<\cdots<y_m''$ on which we can apply \lemref{quad} to
   find a drawing of $Q$.  Now this drawing of $Q$ does not yet satisfy
   the requirements of the theorem because there are vertices $r_i\in
   C$ that are not in $C'$. However, the choice of $y_1'<\cdots<y_d'$
   described above ensures that moving the vertex $r_i$ to $(0,y_i)$
   does not introduce any crossings and gives a drawing of $Q$ that
   satisfies all the relevant requirements of the theorem.  Finally,
   in the process of building $Q$ described above, we showed how the
   drawing of $Q$ can be extended to a drawing of $T$ that satisifies
   all the requirements of the theorem.
\end{proof}



%\begin{lem}
%   Let $Q$ be a straight-line drawing of a quadrangulation each of whose edges intersect the
%   y-axis in exactly one point.  Let $v$ be a vertex of $Q$ that is not on
%   the y-axis, whose incident edges $vx_1,\ldots,vx_d$ intersect
%   the y-axis at y-coordinates $y_1'<\cdots<y_d'$, respectively, 
%   and suppose that no
%   other edges of $Q$ intersect the y-axis with y-coordinates in the interval 
%   $[y_1',y_d']$.
%   Then there is a unique index $i\in\{1,\ldots,d\}$ such that
%   \begin{enumerate}
%     \item for every $j\in\{1,\ldots,i-1\}$, all edges incident to $x_j$, aside from $vx_j$ intersect the y-axis below $(0,y_1')$;
%     \item for every $j\in\{i+1,\ldots,d\}$, all edges incident to $x_j$, aside from $vx_j$ intersect the y-axis above $(0,y_d')$; and
%     \item the embedding of $Q$ obtained by moving $v$ to $(0,y_i')$ is a straight-line drawing.
%   \end{enumerate}
%\end{lem}
%
%\begin{proof}
%   For the first two points, suppose on the contrary that there is some
%   pair of indices $k < \ell$ such that $x_k$ is incident to an edge
%   $wx_k$ that crosses the y-axis at some point $p$ above $(0,y_d')$
%   and $x_\ell$ is incident to an edge $ux_\ell$ that crosses the y-axis
%   at some point $q$ below $(0,y_1')$. Consider the triangle $abc$ with
%   $a=(0,y_k')$, $b=x_k$, and $c=p$.  Then the path $v,x_\ell,u$ enters
%   the interior of $abc$ through the segment $ac$ and exits through one of
%   the other two segments.  But this is a contradiction to the assumption
%   that $Q$ is a straight-line drawing, since it implies that one of the
%   edges in this path crosses at least one of the edges $vx_k$ or $wx_k$.
%
%   For the third point, observe 
%\end{proof}

\subsection{Drawing Collinear Sets}


We will sometimes make use of this simple fact:
\begin{obs}\obslabel{quad}
  If $q=abcd$ is a simple quadrilateral, then neither of the segments $ac$
  or $bd$ cross any of the edges of $q$
\end{obs}

\begin{thm}
   Let
   \begin{compactenum}
     \item  $T$ be a triangulation with outer face $f$;
     \item  $C:[0,1]\to\R^2$ be a Jordan curve whose endpoint $C(0)=C(1)$
            is in the interior of $f$ and whose intersection with each
            edge of $Q$ consists of at most one point;
     \item $r_1,\ldots,r_k$ be the sequence of vertices and open edges
           of $Q$ that are intersected by $C$, and ordered in the order
           that they are intersected by $C$;
     \item $y_1<\cdots<y_k$ be any sequence of numbers.  
     \item $\Delta$ is a triangle that is compatible with 
           $r_1,\ldots,r_m$ and $y_1,\ldots,y_m$.
  \end{compactenum}
   Then, for any $\epsilon>0$, $T$ has a
   straight-line drawing in which the outer face $f$ is $\Delta$
   and, for each $i\in\{1,\ldots,k\}$, 
   \begin{compactenum}
       \item $r_i$ is drawn on the y-axis, with y-coordinate $y_i$
         if $r_i$ is a vertex; or
       \item (if $r_i$ is an edge) the intersection of $r_i$ with the
         y-axis has a y-coordinate in the interval
         $[y_i-\epsilon,y_i+\epsilon]$.
   \end{compactenum}
\end{thm}

\begin{proof}
   Let $L$ and $R$ be the bounded
   and unbounded components, respectively, of $\R^2\setminus J$. Let
   $\bar{L}=C\cup L$ and $\bar{R}=C\cup R$ denote the closures of $L$
   and $R$.  We say that an edge of $T$ is a \emph{crossing edge} if
   it intersects $R$ but is not contained in $R$.  (Note the asymmetry
   of this definition with respect to $L$ and $R$.)  A crossing edge
   is a \emph{proper crossing edge} if it intersects both $R$ and $L$.
   We say that points in $L$ are \emph{to the left of $C$} and points
   in $R$ are \emph{to the right of $C$}.
   The proof is by induction on the number of vertices of $T$.

   \paragraph{Separating Triangles:}
   If $T$ contains a separating triangle $xyz$ then we remove all vertices
   from the interior of $xyz$ to obtain a triangulation $T^+$ in which
   $xyz$ is a face.  Since the intersection of $C$ with each of $xy$,
   $yz$ and $zx$ consists of at most a single point, the vertices and
   edges of $T$ intersected by $C$ that are not in $T^+$ appear as a
   contiguous subsequence $r_i,\ldots,r_j$.

   Observe that each of $r_{i-1}$ and $r_{j+1}$ is either an edge
   or vertex of the triangle $xyz$.  Set $\epsilon'$ to be any
   value less than $\min\{\epsilon,y_{i}-y_{i-1}, y_{j+1}-y_j\}$.
   and apply induction on $T^+$ using the value $\epsilon'$
   and the sequences $r_1,\ldots,r_{i-1},r_{j+1},\ldots,r_k$ and
   $y_1,\ldots,y_{i-1},y_{j+1},\ldots,y_k$ to obtain a drawing of $T^+$.
   In the resulting drawing $xyz$ becomes a triangular face $\Delta'$.

   In the resulting drawing, Let $y_{i-1}'$ and $y_{j+1}'$
   be the respective y-coordinates of the intersections of
   $r_{i-1}$ and $r_{j+1}$ with the y-axis.  By our choice of
   $\epsilon'$, $y_{i-1}'<y_i<\cdots<y_j<y_{j+1}'$.  Observe that
   $\Delta'$ is compatible with $r_{i-1},\ldots,r_{j+1}$ and
   $y_{i-1}',y_i,\ldots,y_j,y_{j+1}'$.

   Let $T^-$ be the triangulation obtained by removing, from $T$, all
   vertices outside of $xyz$.  Now we apply induction on $T^-$ using
   the triangle $\Delta'$ and the sequences $r_{i-1},\ldots,r_{j+1}$ and
   $y_{i-1}',y_i,\ldots,y_{j},y_{j+1}'$.  Combining the drawings of $T^+$
   and $T^-$ yields a drawing of $T$ that satisfies the requirements of
   the theorem.  Thus, we may assume that $T$ has no separating triangles.

   \paragraph{Contractible Edges:}
   We say that a triangular face of $T$ is a \emph{proper crossing face}
   if it is incident to two proper crossing edges.  We say that an edge
   of $T$ is \emph{contractible} if it is not on the boundary of any
   proper crossing face and at least one of its endpoints is not on $C$.

   If $T$ contains a contractible edge $xy$ with $y\not\in C$,
   then we contract $xy$ to obtain a new vertex $u$ in a smaller
   triangulation $T'$.   We can then apply induction on $T'$ with
   the value $\epsilon'=\epsilon/2$ to obtain a drawing of $T'$ that
   satisfies all the conditions of the theorem except that now each proper
   crossing edge $e_i$ intersects the y-axis with distance $\epsilon/2$ of
   $(0,y_i)$.  

   To obtain a drawing of $T$ we uncontract $v$ by placing $x$ at
   the location of $v$ and $y$ very close to $x$ and in a direction
   determined by the directions of the edges in $T'$ incident to $v$.
   As long as the distance between $y$ and $x$ is less than $\epsilon/2$,
   each proper crossing edge $e_i$ incident on $x$ will intersect the
   y-axis within distance $\epsilon$ of $y_i$.

   \paragraph{The Base Case:}
   The base case in our inductive proof occurs when $T$ has no separating
   triangles and no contractible edges.  Note that this implies that
   every vertex $v$ of $T$ is incident to at least one crossing edge
   since, otherwise every edge incident to $v$ is contractible.
  
   Next,  note that if the number, $n$, of vertices of $T$ is 3 then
   the theorem is trivial, so we assume from this point on that $T$
   has at least 4 vertices.

   We will now show how to remove edges and vertices from $T$ in such a
   way that we are left with a quadrangulation $Q$ that only crossing
   edges.  We can then use the results from \secref{quad}
   to draw $Q$ so that it satisifies the conditions of the theorem.
   While removing edges and vertices of $T$ we will show how these edges
   and vertices can be added back to the drawing of $Q$ to obtain a
   drawing of $T$.  All of this will be done with any $\epsilon$s. The
   intersection of each $r_i$ with with the y-axis will be exactly
   at $(0,y_i)$.

   Consider the graph $H$ consisting of only the non-crossing edges of
   $T$ and their endpoints.  Some face $g$ of $H$ contains the jordan
   curve $J$.  We claim that $H$ is outerplanar because every vertex of
   $H$ is incident to at least one crossing edge and is therefore on the
   boundary of $g$.  Furthermore, every edge $e$ of $H$ is on the boundary
   of $g$ since, otherwise, neither of the two triangles incident on $e$
   would be proper crossing triangles and $e$ would be contractible.
   This means that $H$ is a \emph{cactus graph}---a graph in which each
   edge is incident to at most one cycle.  Furthermore, each cycle of $H$
   is a 3-cycle.  To see why, observe that, since $T$ is a triangulation,
   if $H$ contained a $k$-cycle for $k\ge 4$, this cycle would have a chord.

   Consider each 2-connected component of $H$ (which is either a 3-cycle
   or a single edge) and assume, without loss of generality that the
   component is contained in $\bar L$.  There are several cases to
   consider:
   \begin{enumerate}
	\item The component is a single edge $xy$.  Let $xya$ and $yxb$
	be the two faces of $T$ incident to $xy$.
        \begin{enumerate}
            \item if either $a$ or $b$ is in $\bar L$ the one of $xya$
            or $yxb$ is a cycle in $H$, so $xy$ is not a 2-connected
            component of $H$.  \item both $a$ and $b$ are in $R$.  In this
            case, removing the edge $xy$ from $T$ creates a quadrangular
            face $xbya$ consisting of only crossing edges. \obsref{quad}
            ensures that, after drawing this smaller graph, the edge $xy$
            can be added without introducing crossings.  (It is worth
            noting that the analysis of this case remains true even if
            $xy$ is an edge of the outer face.)
        \end{enumerate}
        \item The component is a face $xyz$ of $T$.  Since none of $xy$,
        $yz$, or $zx$ was contracted, there exists vertices $a,b,c\in R$
        (possibly not distinct) such that $xya$, $yzb$ and $zxc$ are
        triangular faces of $T$.\footnote{Note that this is even true if
        $xy$ was not contracted because $x,y\in C$. In that case there
        is still an $a\in R$.}  There are three cases to consider:
        \begin{enumerate}
          \item $a=b=c$.  In this case (after appropriate relabelling),
            the cycle $xya$ contains $z$ in its interior.  Since $T$
            contains no separating triangles, this means that $xya$
            is the outer face of $T$. In this case, we can apply
            the theorem inductively on two in dependent subproblems
            contained in the interior of $xza$ and $azy$, respectively.
          \item $a=b\neq c$. In this case we remove the vertex $y$
            and the edge $xz$.  This create a quadrangular face $zcxa$
            consisting of only crossing edges.  Given a drawing of
            this smaller graph that satisifies the requirements of the
            theorem, \obsref{quad} ensures that we can add the edge $xz$
            without introducing crossings.  Note that $y$ is incident
            on the crossing edge $ya$, which has a prescribed point $p$
            at which it should intersect the y-axis.  Therefore we place
            $y$ at the intersection of the vertical line through $z$
            and the line containing $p$ and $a$.
          \item $a$, $b$, and $c$ are three distinct vertices of $T$.
            Note that, in this case, $Q$ does not contain the edge $yc$
            since, if it did, then $yxc$ would be a separating triangle
            that separates $a$ from $b$.  To handle this case we remove
            the edges $xy$, $yz$ and $zx$ and add the edge $yc$.
            This creates two quadrangular faces $ycxa$ and $ybzc$.
            In the drawing of this smaller graph, the vertices $x$ and
            $z$ are reflex vertices of these two faces.  Thus we can
            remove the edge $yc$ and add the edges $xy$, $yz$ adn $zx$
            without introducing crossings.

            TODO: Note that adding $yc$ may create separating triangles and explain why this doesn't cause any problems.
      \end{enumerate}
   \end{enumerate}
   After applying the preceding reduction to each 2-connected component
   of $H$ we are left with a graph $Q$ that contains only crossing
   edges.  The graph $Q$ is therefore bipartite and therefore contains
   no triangles.  Furthermore, no reduction creates any face with more
   than 4 vertices. Therefore $Q$ is a quadrangulation consisting only
   of crossing edges.  

\end{proof}



\section{Discussion}

Discuss all the consequences of \lemref{free} here\ldots
Basically, any graph class that has a collinear set of size $f(n)$ can 
be untangled while keeping $f(n)$ vertices fixed.  For such graph classes,
every point set of size $f(n)$ is a universal subset for $n$-vertex graphs
in the class.



\end{document}


